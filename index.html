<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Real-time busyness tracking for Edinburgh and Glasgow. Find the best time to swim." />
  <meta name="keywords" content="Edinburgh pools, swimming, pool busyness, Edinburgh Leisure, Pool Pulse" />
  <title>Pool Pulse - Edinburgh and Glasgow Pool Busyness</title>

  <!-- Prevent favicon 404 noise -->
  <link rel="icon" href="data:," />

  <!-- React -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Babel for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind CSS (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>

  <style>
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fadeIn { animation: fadeIn 0.3s ease-out; }
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // -----------------------
    // Supabase
    // -----------------------
    const SUPABASE_URL = "https://hygjskvfkucuwtcihbiw.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh5Z2pza3Zma3VjdXd0Y2loYml3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEyNjQ4OTMsImV4cCI6MjA4Njg0MDg5M30.SSrSE9J9-hs0kZNIzUMBCPST5T_JXZG5I68UF4ZjgLs";
    const supa = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
    window.supa = supa; // handy for debugging in console

    // -----------------------
    // Icons (Lucide)
    // -----------------------
const Droplets = (props) => <span {...props}>üíß</span>;
const Users = (props) => <span {...props}>üë•</span>;
const Clock = (props) => <span {...props}>‚è∞</span>;
const MapPin = (props) => <span {...props}>üìç</span>;
const ArrowLeft = (props) => <span {...props}>‚¨ÖÔ∏è</span>;
const Activity = (props) => <span {...props}>üìä</span>;
const Waves = (props) => <span {...props}>üåä</span>;
    // -----------------------
    // Data
    // -----------------------
    const POOLS = [
      {
        id: "royal-commonwealth",
        name: "Royal Commonwealth Pool",
        location: "Dalkeith Road",
        color: "#0EA5E9",
        hours: {
          weekday: { open: "05:30", close: "22:00" },
          saturday: { open: "05:30", close: "20:00" },
          sunday: { open: "07:30", close: "20:00" },
          wednesdayClosed: { start: "09:00", end: "10:00" },
        },
      },
      {
        id: "warrender",
        name: "Warrender Swim Centre",
        location: "Thirlestane Road",
        color: "#8B5CF6",
        hours: {
          weekday: { open: "06:30", close: "21:30" },
          saturday: { open: "08:00", close: "17:00" },
          sunday: { open: "08:00", close: "17:00" },
        },
      },
      {
        id: "glenogle",
        name: "Glenogle Swim Centre",
        location: "Glenogle Road",
        color: "#10B981",
        hours: {
          weekday: { open: "06:30", close: "21:30" },
          saturday: { open: "08:00", close: "17:00" },
          sunday: { open: "08:00", close: "17:00" },
        },
      },
      {
        id: "leith-victoria",
        name: "Leith Victoria Swim Centre",
        location: "Junction Place",
        color: "#F59E0B",
        hours: {
          weekday: { open: "06:30", close: "21:30" },
          saturday: { open: "08:00", close: "17:00" },
          sunday: { open: "08:00", close: "17:00" },
        },
      },
      {
        id: "dalry",
        name: "Dalry Swim Centre",
        location: "Caledonian Crescent",
        color: "#EF4444",
        hours: {
          weekday: { open: "06:30", close: "21:30" },
          saturday: { open: "08:00", close: "17:00" },
          sunday: { open: "08:00", close: "17:00" },
        },
      },
      {
        id: "portobello",
        name: "Portobello Swim Centre",
        location: "Bellfield Street",
        color: "#EC4899",
        hours: {
          weekday: { open: "06:30", close: "21:30" },
          saturday: { open: "08:00", close: "17:00" },
          sunday: { open: "08:00", close: "17:00" },
        },
      },
      {
        id: "ainslie-park",
        name: "Ainslie Park Leisure Centre",
        location: "Pilton Drive",
        color: "#6366F1",
        hours: {
          weekday: { open: "06:30", close: "21:30" },
          saturday: { open: "08:00", close: "17:00" },
          sunday: { open: "08:00", close: "17:00" },
        },
      },
      {
        id: "western-baths-club",
        name: "Western Baths Club",
        location: "Glasgow (Hillhead / West End)",
        color: "#A855F7",
        hours: {
          weekday: { open: "06:00", close: "21:30" },
          saturday: { open: "07:00", close: "19:30" },
          sunday: { open: "08:00", close: "18:30" },
        },
      },
    ];

    const LANES = [
      { id: "fast", label: "Fast Lane", icon: "üèÉ", color: "bg-red-100 border-red-300 text-red-800" },
      { id: "medium", label: "Medium Lane", icon: "üö∂", color: "bg-yellow-100 border-yellow-300 text-yellow-800" },
      { id: "slow", label: "Slow Lane", icon: "üê¢", color: "bg-green-100 border-green-300 text-green-800" },
    ];

    const laneLabel = (laneId) => {
      const l = LANES.find((x) => x.id === laneId);
      return l ? l.label : laneId;
    };

    // -----------------------
    // App
    // -----------------------
    function PoolBusynessTracker() {
      // Core UI state
      const [poolData, setPoolData] = useState({});
      const [selectedPool, setSelectedPool] = useState("");
      const [selectedLane, setSelectedLane] = useState("");
      const [showSuccess, setShowSuccess] = useState(false);
      const [loading, setLoading] = useState(true);
      const [viewingPool, setViewingPool] = useState(null);

      const [showHomepage, setShowHomepage] = useState(true);
      const [showPrivacyPolicy, setShowPrivacyPolicy] = useState(false);
      const [showTerms, setShowTerms] = useState(false);

      // Supabase check-ins state
      const CHECKIN_WINDOW_MINUTES = 180; // last 3 hours
      const [recentCheckins, setRecentCheckins] = useState([]);
      const [checkinsLoading, setCheckinsLoading] = useState(true);
      const [checkinsError, setCheckinsError] = useState(null);

      const formatTime = (iso) => new Date(iso).toLocaleString();

      const checkinsForPool = (poolId) =>
        recentCheckins.filter((c) => c.pool_id === poolId).slice(0, 10);

  const CHECKIN_WINDOW_MINUTES = 180; // last 3 hours

// Only show the big spinner on the very first load (prevents "blinking")
const loadData = async ({ showSpinner = false } = {}) => {
  try {
    if (showSpinner) setLoading(true);

    const sinceIso = new Date(
      Date.now() - CHECKIN_WINDOW_MINUTES * 60 * 1000
    ).toISOString();

    const { data, error } = await window.supa
      .from("checkins")
      .select("pool_id,lane,delta,created_at")
      .gte("created_at", sinceIso);

    if (error) throw error;

    const agg = {};

    for (const row of data || []) {
      const poolId = row.pool_id;
      const laneId = row.lane;
      const delta = typeof row.delta === "number" ? row.delta : 1;
      const ts = row.created_at;

      if (!agg[poolId]) agg[poolId] = { lanes: {}, totalUpdates: 0, lastUpdate: null };
      agg[poolId].totalUpdates += delta;

      if (!agg[poolId].lanes[laneId]) agg[poolId].lanes[laneId] = { checkInCount: 0, lastUpdate: null };
      agg[poolId].lanes[laneId].checkInCount += delta;

      if (!agg[poolId].lanes[laneId].lastUpdate || ts > agg[poolId].lanes[laneId].lastUpdate) {
        agg[poolId].lanes[laneId].lastUpdate = ts;
      }
      if (!agg[poolId].lastUpdate || ts > agg[poolId].lastUpdate) {
        agg[poolId].lastUpdate = ts;
      }
    }

    setPoolData(agg);
  } catch (e) {
    console.error("loadData error:", e);
  } finally {
    if (showSpinner) setLoading(false);
  }
};

useEffect(() => {
  // Initial load WITH spinner
  loadData({ showSpinner: true });
  loadRecentCheckins();

  // Background refresh WITHOUT spinner (prevents blinking)
  const t = setInterval(() => {
    loadData();
    loadRecentCheckins();
  }, 10000);

  return () => clearInterval(t);
}, []);

const savePoolUpdate = async (poolId, lane) => {
  const lastCheckInKey = "lastCheckIn";
  const lastCheckIn = localStorage.getItem(lastCheckInKey);

  if (lastCheckIn) {
    const timeSinceLastCheckIn = Date.now() - parseInt(lastCheckIn, 10);
    const oneHour = 60 * 60 * 1000;

    if (timeSinceLastCheckIn < oneHour) {
      const minutesLeft = Math.ceil((oneHour - timeSinceLastCheckIn) / 60000);
      alert(`Please wait ${minutesLeft} minutes before checking in again.`);
      return;
    }
  }

  try {
    const { error } = await window.supa
      .from("checkins")
      .insert([{ pool_id: poolId, lane: lane, delta: 1 }]);

    if (error) throw error;

    localStorage.setItem(lastCheckInKey, Date.now().toString());

    setShowSuccess(true);
    setTimeout(() => setShowSuccess(false), 2000);

    setSelectedPool(null);
    setSelectedLane(null);

    // Refresh UI after inserting
    loadData();
    loadRecentCheckins();
  } catch (e) {
    console.error("insert error:", e);
    alert("Failed to save check-in. Please try again.");
  }
};

const handleSubmit = () => {
  if (selectedPool && selectedLane) {
    savePoolUpdate(selectedPool, selectedLane);
  }
};
      const getTimeSince = (timestamp) => {
        if (!timestamp) return "No data yet";
        const now = new Date();
        const then = new Date(timestamp);
        const minutes = Math.floor((now - then) / 60000);

        if (minutes < 1) return "Just now";
        if (minutes < 60) return `${minutes}m ago`;
        const hours = Math.floor(minutes / 60);
        if (hours < 24) return `${hours}h ago`;
        return `${Math.floor(hours / 24)}d ago`;
      };

      const getPoolStatus = (poolId) => {
        const data = poolData[poolId];
        if (!data || !data.lanes) return null;
        if (Object.keys(data.lanes).length === 0) return null;
        return data;
      };

      const isPoolOpen = (pool) => {
        const now = new Date();
        const day = now.getDay(); // 0 Sunday, 6 Saturday
        const currentTime = now.toTimeString().slice(0, 5);

        let hours;
        if (day === 0) hours = pool.hours.sunday;
        else if (day === 6) hours = pool.hours.saturday;
        else {
          hours = pool.hours.weekday;

          if (day === 3 && pool.hours.wednesdayClosed) {
            if (currentTime >= pool.hours.wednesdayClosed.start &&
                currentTime < pool.hours.wednesdayClosed.end) {
              return false;
            }
          }
        }

        return currentTime >= hours.open && currentTime < hours.close;
      };

      const getOpeningHoursText = (pool) => {
        const now = new Date();
        const day = now.getDay();

        let hours;
        if (day === 0) hours = pool.hours.sunday;
        else if (day === 6) hours = pool.hours.saturday;
        else hours = pool.hours.weekday;

        return `${hours.open} - ${hours.close}`;
      };

      // Map "count in last 3 hours" into a friendly label
      const getLaneBusyness = (count) => {
        const c = count || 0;
        if (c === 0) return { label: "Empty", emoji: "üòä", bgColor: "bg-green-100", textColor: "text-green-800" };
        if (c <= 2) return { label: "Quiet", emoji: "üôÇ", bgColor: "bg-lime-100", textColor: "text-lime-800" };
        if (c <= 4) return { label: "Moderate", emoji: "üòê", bgColor: "bg-amber-100", textColor: "text-amber-800" };
        if (c <= 6) return { label: "Busy", emoji: "üò¨", bgColor: "bg-orange-100", textColor: "text-orange-800" };
        return { label: "Very Busy", emoji: "üò∞", bgColor: "bg-red-100", textColor: "text-red-800" };
      };

      // -----------------------
      // Privacy Policy View
      // -----------------------
      if (showPrivacyPolicy) {
        return (
          <div className="min-h-screen bg-gradient-to-br from-teal-50 to-cyan-50">
            <div className="bg-gradient-to-r from-teal-600 to-cyan-600 text-white shadow-lg">
              <div className="max-w-4xl mx-auto px-4 py-6">
                <button
                  onClick={() => { setShowPrivacyPolicy(false); setShowHomepage(true); }}
                  className="flex items-center gap-2 text-teal-100 hover:text-white mb-3 transition-colors"
                >
                  <ArrowLeft className="w-4 h-4" />
                  Back to home
                </button>
                <h1 className="text-3xl font-bold">Privacy Policy</h1>
              </div>
            </div>

            <div className="max-w-4xl mx-auto px-4 py-12">
              <div className="bg-white rounded-xl shadow-lg p-8">
                <p className="text-gray-600 mb-6">Last updated: February 16, 2026</p>

                <h2 className="text-2xl font-bold text-gray-900 mb-4">Our Commitment to Privacy</h2>
                <p className="text-gray-700 mb-6 leading-relaxed">
                  Pool Pulse is built on trust, not surveillance. This app is designed to help swimmers decide when to swim ‚Äî
                  not to identify who they are.
                </p>

                <div className="bg-teal-50 border-2 border-teal-200 rounded-lg p-6 mb-6">
                  <h3 className="font-bold text-lg text-teal-900 mb-2">üîí No Login Required</h3>
                  <p className="text-teal-800 leading-relaxed">
                    Pool Pulse doesn‚Äôt require accounts, emails, or passwords. Check-ins are anonymous.
                  </p>
                </div>

                <h2 className="text-xl font-bold text-gray-900 mb-3">What We Collect</h2>
                <p className="text-gray-700 mb-4 leading-relaxed">When you check in, we store:</p>
                <ul className="list-disc ml-6 mb-6 text-gray-700 space-y-2">
                  <li>Which pool you‚Äôre at</li>
                  <li>Which lane you selected (Fast, Medium, or Slow)</li>
                  <li>The time you checked in</li>
                </ul>

                <h2 className="text-xl font-bold text-gray-900 mb-3">What We Don‚Äôt Collect</h2>
                <ul className="list-disc ml-6 mb-6 text-gray-700 space-y-2">
                  <li>No names, emails, phone numbers</li>
                  <li>No GPS tracking</li>
                  <li>No advertising identifiers</li>
                </ul>

                <h2 className="text-xl font-bold text-gray-900 mb-3">How the Data Is Used</h2>
                <p className="text-gray-700 mb-6 leading-relaxed">
                  Check-ins are used only to show lane busyness to other swimmers. Data is stored in a database (Supabase)
                  so it can be shared across users ‚Äî but it remains anonymous.
                </p>

                <h2 className="text-xl font-bold text-gray-900 mb-3">Questions?</h2>
                <p className="text-gray-700 leading-relaxed">
                  Email me at{" "}
                  <a href="mailto:snehasindhu2109@gmail.com" className="text-teal-600 hover:text-teal-700 underline">
                    snehasindhu2109@gmail.com
                  </a>
                </p>
              </div>
            </div>
          </div>
        );
      }

      // -----------------------
      // Terms View
      // -----------------------
      if (showTerms) {
        return (
          <div className="min-h-screen bg-gradient-to-br from-teal-50 to-cyan-50">
            <div className="bg-gradient-to-r from-teal-600 to-cyan-600 text-white shadow-lg">
              <div className="max-w-4xl mx-auto px-4 py-6">
                <button
                  onClick={() => { setShowTerms(false); setShowHomepage(true); }}
                  className="flex items-center gap-2 text-teal-100 hover:text-white mb-3 transition-colors"
                >
                  <ArrowLeft className="w-4 h-4" />
                  Back to home
                </button>
                <h1 className="text-3xl font-bold">Terms of Service</h1>
              </div>
            </div>

            <div className="max-w-4xl mx-auto px-4 py-12">
              <div className="bg-white rounded-xl shadow-lg p-8">
                <p className="text-gray-600 mb-6">Last updated: February 16, 2026</p>

                <h2 className="text-2xl font-bold text-gray-900 mb-4">Welcome to Pool Pulse</h2>
                <p className="text-gray-700 mb-6 leading-relaxed">
                  Pool Pulse is a free community tool to help swimmers estimate lane busyness using anonymous check-ins.
                </p>

                <h2 className="text-xl font-bold text-gray-900 mb-3">No Guarantees</h2>
                <p className="text-gray-700 mb-6 leading-relaxed">
                  Busyness is based on user check-ins and may not reflect exact current conditions.
                </p>

                <h2 className="text-xl font-bold text-gray-900 mb-3">Be a Good Neighbour</h2>
                <p className="text-gray-700 mb-6 leading-relaxed">
                  Please don‚Äôt spam fake check-ins. The system works because swimmers use it honestly.
                </p>

                <h2 className="text-xl font-bold text-gray-900 mb-3">Questions?</h2>
                <p className="text-gray-700 leading-relaxed">
                  Email{" "}
                  <a href="mailto:snehasindhu2109@gmail.com" className="text-teal-600 hover:text-teal-700 underline">
                    snehasindhu2109@gmail.com
                  </a>
                </p>
              </div>
            </div>
          </div>
        );
      }

      // -----------------------
      // Homepage View
      // -----------------------
     if (showHomepage) {
  return (
    <div className="min-h-screen bg-gradient-to-br from-teal-50 via-cyan-50 to-blue-50">
      {/* Header */}
      <div className="bg-gradient-to-r from-teal-600 to-cyan-600 text-white shadow-lg">
        <div className="max-w-4xl mx-auto px-4 py-8">
          <div className="flex items-center justify-center gap-4 mb-4">
            <div className="relative">
              <div className="absolute inset-0 bg-white/30 rounded-full blur-2xl"></div>
              <div className="relative bg-white/10 backdrop-blur-sm p-4 rounded-3xl border-2 border-white/30 shadow-2xl">
                <Waves className="w-12 h-12" />
              </div>
            </div>
            <div className="text-center">
              <h1 className="text-4xl font-bold mb-1">Pool Pulse</h1>
              <p className="text-teal-100 text-sm font-medium">Edinburgh & Glasgow</p>
            </div>
          </div>
          <p className="text-center text-teal-50 text-lg max-w-2xl mx-auto">
            Know before you go ‚Äî see how busy each lane is, based on anonymous check-ins.
          </p>
        </div>
      </div>

      <div className="max-w-4xl mx-auto px-4 py-12">
        {/* Main CTA */}
        <div className="bg-white rounded-2xl shadow-xl p-8 mb-8">
          <div className="text-center mb-8">
            <h2 className="text-3xl font-bold text-gray-900 mb-4">
              Never waste a walk to a crowded pool again
            </h2>
            <p className="text-lg text-gray-600 max-w-2xl mx-auto">
              Pool Pulse shows lane busyness using community check-ins so you can plan your swim better.
            </p>
          </div>

          <div className="grid md:grid-cols-3 gap-6 mb-8">
            <div className="text-center">
              <div className="bg-teal-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4">
                <Users className="w-8 h-8 text-teal-600" />
              </div>
              <h3 className="font-bold text-lg mb-2">1. Check Before You Go</h3>
              <p className="text-gray-600 text-sm">See lane busyness estimates</p>
            </div>

            <div className="text-center">
              <div className="bg-cyan-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4">
                <MapPin className="w-8 h-8 text-cyan-600" />
              </div>
              <h3 className="font-bold text-lg mb-2">2. Pick Your Pool</h3>
              <p className="text-gray-600 text-sm">Check opening times & status</p>
            </div>

            <div className="text-center">
              <div className="bg-blue-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4">
                <Droplets className="w-8 h-8 text-blue-600" />
              </div>
              <h3 className="font-bold text-lg mb-2">3. Check In</h3>
              <p className="text-gray-600 text-sm">Takes 2 seconds, helps everyone</p>
            </div>
          </div>

          <div className="text-center">
            <button
              onClick={() => setShowHomepage(false)}
              className="bg-gradient-to-r from-teal-600 to-cyan-600 text-white font-bold px-10 py-4 rounded-xl hover:from-teal-700 hover:to-cyan-700 transition-all shadow-lg text-lg"
            >
              View All Pools
            </button>
          </div>
        </div>

        {/* About Me Section */}
        <div className="bg-white rounded-2xl shadow-xl p-8 mb-8">
          <div className="grid md:grid-cols-3 gap-8 items-center">
            {/* Left side - Image/Avatar */}
            <div className="text-center md:col-span-1">
              <div className="bg-gradient-to-br from-teal-200 to-cyan-200 rounded-full w-32 h-32 mx-auto flex items-center justify-center shadow-lg">
                <span className="text-6xl">üèä</span>
              </div>
              <h3 className="text-xl font-bold text-gray-900 mt-4">Sneha</h3>
              <p className="text-teal-600 font-semibold">Swimmer & Creator</p>
            </div>

            {/* Right side - Bio */}
            <div className="md:col-span-2">
              <h2 className="text-2xl font-bold text-gray-900 mb-4">About Pool Pulse</h2>
              <p className="text-gray-700 mb-4 leading-relaxed">
                I'm a swimmer who got tired of wasting trips to crowded pools while training for open water swims in Scotland in 2025. I created <strong>Pool Pulse</strong> to solve this problem with a privacy-first solution that helps the swimming community make smarter decisions.
              </p>
              <p className="text-gray-700 mb-4 leading-relaxed">
                Every swimmer contributes anonymously when they check in. No names, no location tracking, just real-time lane busyness insights that help everyone find the perfect time to swim.
              </p>
              <p className="text-gray-700 leading-relaxed">
                Whether you're training hard, getting a casual swim, or avoiding peak hours, <strong>Pool Pulse</strong> has your back. üåä
              </p>
            </div>
          </div>
        </div>

       {/* Swimming Gallery */}
<div className="bg-white rounded-2xl shadow-xl p-8 mb-8">
  <h2 className="text-2xl font-bold text-gray-900 mb-6 text-center">Why Pool Pulse? üíß</h2>
  <div className="grid md:grid-cols-3 gap-4">
    <div className="rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-shadow">
      <img src="https://images.unsplash.com/photo-1576610616656-570ceed35b1e?w=400&h=300&fit=crop" alt="Swimming" className="w-full h-48 object-cover"/>
      <div className="p-4 bg-teal-50">
        <p className="font-bold text-teal-900">Smart Planning</p>
        <p className="text-sm text-gray-600">Know lane busyness before you go</p>
      </div>
    </div>
    <div className="rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-shadow">
      <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=300&fit=crop" alt="Community" className="w-full h-48 object-cover"/>
      <div className="p-4 bg-cyan-50">
        <p className="font-bold text-cyan-900">Community</p>
        <p className="text-sm text-gray-600">Help other swimmers with your check-ins</p>
      </div>
    </div>
    <div className="rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-shadow">
      <img src="https://images.unsplash.com/photo-1552635527-bb4b60ce6860?w=400&h=300&fit=crop" alt="Privacy" className="w-full h-48 object-cover"/>
      <div className="p-4 bg-blue-50">
        <p className="font-bold text-blue-900">Privacy First</p>
        <p className="text-sm text-gray-600">Anonymous check-ins, no tracking</p>
      </div>
    </div>
  </div>
</div>
        {/* Pools Covered Section */}
        <div className="bg-white rounded-2xl shadow-xl p-8 mb-8">
          <h2 className="text-2xl font-bold text-gray-900 mb-2">Pools Covered</h2>
          <p className="text-gray-600 mb-6">Currently tracking busyness at {POOLS.length} pools in Edinburgh and Glasgow</p>
          
          <div className="grid md:grid-cols-2 gap-4">
            {POOLS.map((pool) => (
              <div
                key={pool.id}
                className="border-l-4 p-4 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors"
                style={{ borderColor: pool.color }}
              >
                <h3 className="font-bold text-lg text-gray-900 mb-1">{pool.name}</h3>
                <div className="flex items-center gap-1 text-gray-600 text-sm">
                  <MapPin className="w-4 h-4" />
                  <span>{pool.location}</span>
                </div>
                <div className="flex items-center gap-1 text-gray-600 text-sm mt-2">
                  <Clock className="w-4 h-4" />
                  <span className="text-xs">
                    {pool.hours.weekday.open} - {pool.hours.weekday.close}
                  </span>
                </div>
              </div>
            ))}
          </div>

          <div className="bg-teal-50 border-2 border-teal-200 rounded-lg p-4 mt-6">
            <p className="text-teal-900 text-sm">
              <strong>üéØ Pilot Phase:</strong> More pools coming soon!
            </p>
          </div>
        </div>

        {/* Footer */}
        <div className="mt-12 text-center text-gray-500 text-sm">
          <p>üîí Anonymous check-ins ‚Ä¢ No accounts required ‚Ä¢ Privacy first</p>
          <p className="mt-2">
            Made with üíô by Sneha ‚Ä¢{" "}
            <a href="mailto:snehasindhu2109@gmail.com" className="text-teal-600 hover:text-teal-700 underline">
              Contact me
            </a>
          </p>

          <p className="mt-4">
            <button
              onClick={() => { setShowHomepage(false); setShowPrivacyPolicy(true); }}
              className="text-gray-500 hover:text-gray-700 underline mr-4"
            >
              Privacy Policy
            </button>
            <button
              onClick={() => { setShowHomepage(false); setShowTerms(true); }}
              className="text-gray-500 hover:text-gray-700 underline"
            >
              Terms of Service
            </button>
          </p>
        </div>
      </div>
    </div>
  );
}

      // -----------------------
      // Loading screen
      // -----------------------
      if (loading) {
        return (
          <div className="min-h-screen bg-gradient-to-br from-teal-50 to-cyan-50 flex items-center justify-center">
            <div className="text-center">
              <div className="relative inline-block">
                <Waves className="w-16 h-16 text-teal-500 animate-pulse" />
                <Droplets className="w-8 h-8 text-cyan-500 animate-bounce absolute top-0 right-0" />
              </div>
              <p className="text-gray-600 mt-4">Loading pool data...</p>
            </div>
          </div>
        );
      }

      // -----------------------
      // Pool Detail View
      // -----------------------
      if (viewingPool) {
        const pool = POOLS.find((p) => p.id === viewingPool);
        const poolStatus = getPoolStatus(viewingPool);
        const isOpen = isPoolOpen(pool);
        const hoursText = getOpeningHoursText(pool);

        return (
          <div className="min-h-screen bg-gradient-to-br from-teal-50 to-cyan-50 pb-20">
            <div
              className="text-white shadow-lg"
              style={{ background: `linear-gradient(to right, ${pool.color}, ${pool.color}dd)` }}
            >
              <div className="max-w-2xl mx-auto px-4 py-4">
                <button
                  onClick={() => setViewingPool(null)}
                  className="flex items-center gap-2 text-white/80 hover:text-white mb-3 transition-colors"
                >
                  <ArrowLeft className="w-5 h-5" />
                  Back to all pools
                </button>

                <div className="flex items-center gap-3 mb-2">
                  <div className="relative">
                    <div className="absolute inset-0 bg-white/20 rounded-full blur-md"></div>
                    <div className="relative bg-white/10 backdrop-blur-sm p-2 rounded-2xl border-2 border-white/30">
                      <Waves className="w-7 h-7" />
                    </div>
                  </div>

                  <div>
                    <div className="flex items-center gap-2 mb-1">
                      <h1 className="text-2xl font-bold">{pool.name}</h1>
                      {isOpen ? (
                        <span className="bg-white/20 backdrop-blur-sm text-white text-xs font-bold px-3 py-1 rounded-full border border-white/30">
                          OPEN NOW
                        </span>
                      ) : (
                        <span className="bg-red-500 text-white text-xs font-bold px-3 py-1 rounded-full">
                          CLOSED
                        </span>
                      )}
                    </div>

                    <div className="flex items-center gap-1 text-white/90 text-sm mt-1">
                      <MapPin className="w-4 h-4" />
                      <span>{pool.location}</span>
                    </div>

                    <div className="flex items-center gap-1 text-white/80 text-xs mt-1">
                      <Clock className="w-3 h-3" />
                      <span>Today: {hoursText}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div className="max-w-2xl mx-auto px-4 py-6">
              {/* Recent check-ins */}
              <div className="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h2 className="text-xl font-bold text-gray-900 mb-4">Recent check-ins</h2>

                {checkinsLoading && <div className="text-gray-500">Loading‚Ä¶</div>}
                {checkinsError && <div className="text-red-600">Error: {checkinsError}</div>}

                {!checkinsLoading && !checkinsError && (
                  <div className="space-y-2">
                    {checkinsForPool(pool.id).length === 0 ? (
                      <div className="text-gray-500">No check-ins yet.</div>
                    ) : (
                      checkinsForPool(pool.id).map((c) => (
                        <div key={c.id} className="flex items-center justify-between border rounded-lg p-3">
                          <div>
                            <div className="font-medium">{laneLabel(c.lane)}</div>
                            <div className="text-sm text-gray-600">{formatTime(c.created_at)}</div>
                          </div>
                          <div className="text-sm text-gray-700">+{c.delta ?? 1}</div>
                        </div>
                      ))
                    )}
                  </div>
                )}

                <div className="text-xs text-gray-500 mt-4">
                  Counts in the app are based on check-ins in the last {CHECKIN_WINDOW_MINUTES} minutes.
                </div>
              </div>

              {/* Lane status */}
              {poolStatus ? (
                <div className="bg-white rounded-xl shadow-lg p-6 mb-6">
                  <div className="flex items-center gap-2 mb-4">
                    <Activity className="w-5 h-5 text-teal-600" />
                    <h2 className="text-xl font-bold text-gray-900">Current Lane Status</h2>
                  </div>

                  <div className="space-y-4">
                    {LANES.map((lane) => {
                      const laneData = poolStatus.lanes[lane.id];
                      const count = laneData?.checkInCount || 0;
                      const busyness = getLaneBusyness(count);

                      return (
                        <div key={lane.id} className={`border-2 rounded-lg p-4 ${lane.color}`}>
                          <div className="flex items-center justify-between mb-2">
                            <div className="flex items-center gap-2">
                              <span className="text-2xl">{lane.icon}</span>
                              <h3 className="font-bold text-lg">{lane.label}</h3>
                            </div>

                            <div className="flex items-center gap-2">
                              <div className={`${busyness.bgColor} ${busyness.textColor} px-4 py-2 rounded-lg font-bold text-base flex items-center gap-2`}>
                                <span>{busyness.emoji}</span>
                                <span>{busyness.label}</span>
                              </div>

                              <div className="text-white px-3 py-2 rounded-lg font-bold text-sm" style={{ backgroundColor: pool.color }}>
                                {count} check-ins
                              </div>
                            </div>
                          </div>

                          {laneData?.lastUpdate ? (
                            <div className="flex items-center gap-1 text-sm mt-2">
                              <Clock className="w-4 h-4" />
                              <span>Last check-in {getTimeSince(laneData.lastUpdate)}</span>
                            </div>
                          ) : (
                            <p className="text-sm italic opacity-70">No check-ins yet</p>
                          )}
                        </div>
                      );
                    })}
                  </div>

                  <div className="mt-6 pt-6 border-t border-gray-200">
                    <div className="flex items-center justify-between text-sm text-gray-600">
                      <div className="flex items-center gap-1">
                        <Clock className="w-4 h-4" />
                        <span>Last updated {getTimeSince(poolStatus.lastUpdate)}</span>
                      </div>
                      <div className="flex items-center gap-1">
                        <Users className="w-4 h-4" />
                        <span>{poolStatus.totalUpdates} check-ins (last {CHECKIN_WINDOW_MINUTES} mins)</span>
                      </div>
                    </div>
                  </div>
                </div>
              ) : (
                <div className="bg-white rounded-xl shadow-lg p-8 text-center mb-6">
                  <Users className="w-16 h-16 text-gray-300 mx-auto mb-4" />
                  <h3 className="text-xl font-bold text-gray-900 mb-2">No Check-Ins Yet</h3>
                  <p className="text-gray-600">Be the first to check in at this pool!</p>
                </div>
              )}

              <div className="text-center">
                <button
                  onClick={() => { setSelectedPool(viewingPool); setViewingPool(null); }}
                  className="text-white font-bold px-8 py-3 rounded-lg hover:opacity-90 transition-all shadow-md"
                  style={{ backgroundColor: pool.color }}
                >
                  Check In At This Pool
                </button>
              </div>
            </div>
          </div>
        );
      }

      // -----------------------
      // Main Pool List View
      // -----------------------
      return (
        <div className="min-h-screen bg-gradient-to-br from-teal-50 to-cyan-50 pb-20">
          <div className="bg-gradient-to-r from-teal-600 to-cyan-600 text-white shadow-lg">
            <div className="max-w-2xl mx-auto px-4 py-6">
              <button
                onClick={() => setShowHomepage(true)}
                className="flex items-center gap-2 text-teal-100 hover:text-white mb-3 transition-colors text-sm"
              >
                <ArrowLeft className="w-4 h-4" />
                Back to home
              </button>

              <div className="flex items-center gap-3 mb-2">
                <div className="relative">
                  <div className="absolute inset-0 bg-white/20 rounded-full blur-lg"></div>
                  <div className="relative bg-white/10 backdrop-blur-sm p-3 rounded-2xl border-2 border-white/30 shadow-xl">
                    <Waves className="w-8 h-8" />
                  </div>
                </div>
                <div>
                  <h1 className="text-2xl font-bold">Pool Pulse</h1>
                  <p className="text-teal-100 text-xs font-medium">Edinburgh & Glasgow</p>
                </div>
              </div>

              <p className="text-teal-50 text-sm">
                Lane busyness based on anonymous check-ins in the last {CHECKIN_WINDOW_MINUTES} minutes
              </p>
            </div>
          </div>

          {showSuccess && (
            <div className="fixed top-20 left-1/2 transform -translate-x-1/2 bg-teal-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-bounce">
              ‚úì Checked in! Have a great swim
            </div>
          )}

          <div className="max-w-2xl mx-auto px-4 py-6">
            <div className="space-y-4 mb-6">
              {POOLS.map((pool) => {
                const poolStatus = getPoolStatus(pool.id);
                const isOpen = isPoolOpen(pool);
                const hoursText = getOpeningHoursText(pool);

                return (
                  <div
                    key={pool.id}
                    className="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-shadow cursor-pointer"
                    onClick={() => setViewingPool(pool.id)}
                    style={{ borderLeft: `6px solid ${pool.color}` }}
                  >
                    <div className="p-5">
                      <div className="flex justify-between items-start mb-3">
                        <div className="flex-1">
                          <div className="flex items-center gap-2 mb-1">
                            <h3 className="font-bold text-lg text-gray-900">{pool.name}</h3>
                            {isOpen ? (
                              <span className="bg-green-100 text-green-800 text-xs font-bold px-2 py-1 rounded-full">OPEN</span>
                            ) : (
                              <span className="bg-red-100 text-red-800 text-xs font-bold px-2 py-1 rounded-full">CLOSED</span>
                            )}
                          </div>

                          <div className="flex items-center gap-1 text-gray-500 text-sm">
                            <MapPin className="w-4 h-4" />
                            <span>{pool.location}</span>
                          </div>

                          <div className="flex items-center gap-1 text-gray-500 text-xs mt-1">
                            <Clock className="w-3 h-3" />
                            <span>Today: {hoursText}</span>
                          </div>
                        </div>
                      </div>

                      {poolStatus ? (
                        <div className="space-y-3">
                          <div className="grid grid-cols-3 gap-2">
                            {LANES.map((lane) => {
                              const laneData = poolStatus.lanes[lane.id];
                              const count = laneData?.checkInCount || 0;
                              const busyness = getLaneBusyness(count);

                              return (
                                <div key={lane.id} className="text-center">
                                  <div className="text-lg mb-1">{lane.icon}</div>
                                  <div className={`${busyness.bgColor} ${busyness.textColor} px-2 py-1 rounded text-xs font-bold flex items-center justify-center gap-1`}>
                                    <span>{busyness.emoji}</span>
                                    <span>{busyness.label}</span>
                                  </div>
                                </div>
                              );
                            })}
                          </div>

                          <div className="flex items-center justify-between text-sm text-gray-500 pt-2 border-t border-gray-100">
                            <div className="flex items-center gap-1">
                              <Clock className="w-4 h-4" />
                              <span>{getTimeSince(poolStatus.lastUpdate)}</span>
                            </div>
                            <div className="font-semibold" style={{ color: pool.color }}>
                              Tap for details ‚Üí
                            </div>
                          </div>
                        </div>
                      ) : (
                        <div className="text-gray-400 text-sm italic">
                          No check-ins yet ‚Äî tap to view or be the first!
                        </div>
                      )}
                    </div>
                  </div>
                );
              })}
            </div>

            {/* Check In box */}
            <div className="bg-white rounded-xl shadow-lg p-6 sticky bottom-4">
              <h2 className="text-xl font-bold text-gray-900 mb-4">Check In</h2>

              <div className="mb-4">
                <label className="block text-sm font-semibold text-gray-700 mb-2">
                  Which pool are you at?
                </label>
                <select
                  value={selectedPool}
                  onChange={(e) => setSelectedPool(e.target.value)}
                  className="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-teal-500 focus:outline-none"
                >
                  <option value="">Select a pool...</option>
                  {POOLS.map((pool) => (
                    <option key={pool.id} value={pool.id}>{pool.name}</option>
                  ))}
                </select>
              </div>

              {selectedPool && (
                <div className="mb-4 animate-fadeIn">
                  <label className="block text-sm font-semibold text-gray-700 mb-3">
                    What lane are you swimming in?
                  </label>
                  <div className="grid grid-cols-3 gap-3">
                    {LANES.map((lane) => (
                      <button
                        key={lane.id}
                        onClick={() => setSelectedLane(lane.id)}
                        className={`p-4 rounded-lg border-2 transition-all ${
                          selectedLane === lane.id
                            ? "border-teal-500 bg-teal-50 shadow-md"
                            : "border-gray-200 hover:border-gray-300"
                        }`}
                      >
                        <div className="text-3xl mb-2">{lane.icon}</div>
                        <div className="font-semibold text-sm text-gray-900">
                          {lane.label.replace(" Lane", "")}
                        </div>
                      </button>
                    ))}
                  </div>
                </div>
              )}

              {selectedPool && selectedLane && (
                <button
                  onClick={handleSubmit}
                  className="w-full bg-gradient-to-r from-teal-600 to-cyan-600 text-white font-bold py-4 rounded-lg hover:from-teal-700 hover:to-cyan-700 transition-all shadow-md mt-4"
                >
                  I'm Swimming Here Now
                </button>
              )}

              {!selectedPool && (
                <p className="text-center text-gray-500 text-sm">
                  Select a pool to get started
                </p>
              )}

              <div className="mt-4 text-xs text-gray-500 text-center">
                Your check-in is anonymous. Please check in honestly ‚ù§Ô∏è
              </div>
            </div>

            <div className="mt-6 text-center text-gray-500 text-sm">
              <p>Community-powered lane tracking for swimmers</p>
              <p className="mt-1">Check in when you arrive ‚Ä¢ See estimated lane busyness</p>
            </div>
          </div>
        </div>
      );
    }

    // Mount the app
    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<PoolBusynessTracker />);
  </script>
</body>
</html>
